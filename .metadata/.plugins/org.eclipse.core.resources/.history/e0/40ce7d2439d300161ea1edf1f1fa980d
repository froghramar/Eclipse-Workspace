import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Scanner;

public class Init {
    public static void main(String[] args) throws Exception {

        int port = 1025;
        ServerSocket serverSocket = null;
        
        try{
        	serverSocket = new ServerSocket(port);
        } catch(Exception e){
        	System.out.println("Port " + port + " is bussy");
        	return;
        }
        

        while (true) {

            Socket clientSocket = serverSocket.accept();
            System.out.println("Request Accepted");

            BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
            PrintWriter out = new PrintWriter(new OutputStreamWriter(clientSocket.getOutputStream()));
            
            String s, url = null;
            while ((s = in.readLine()) != null) {
                if (s.isEmpty()) {
                    break;
                }
                if(url == null) url = s;
            }
            
            String tok[] = url.split(" ");
            if(tok[0] != "GET"){
            	System.out.println("Holly");
            	out.close();
                in.close();
                clientSocket.close();
            	return;
            }
            url = tok[1];
            System.out.println(url);
            
            
            try{
            	Scanner fin = new Scanner(new File("/home/froghramar/Dropbox/Eclipse/HTTPServer/src/Files" + url));
            	out.write("HTTP/1.0 200 OK\r\n");
                out.write("Date: Fri, 31 Dec 1999 23:59:59 GMT\r\n");
                out.write("\r\n");
            	while(fin.hasNext()){
            		s = fin.nextLine();
            		out.println(s);
            	}
            	fin.close();
            } catch(Exception e){
            	out.print("File Not Found!");
            }

            out.close();
            in.close();
            clientSocket.close();
        }
        
    }
    
}